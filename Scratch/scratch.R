# Copyright 2019 Province of British Columbia
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
# http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and limitations under the License.

##############################
###  01_load.R           #####
##############################

# load library dependencies
library(data.table)
library(openxlsx)
library(dplyr)
library(stringr)
library(here)

# set and locate the working directory in which the data files are stored
# here() #the file path to the data folder containing xlsx

filepath <- here("Data", "2015_IND_Tables_1_to_13_Canada.xlsx")

# load tax data from individuals (per year) xlsx tables into R 
#read file path for individual income table 1
dat1 <- read.xlsx(filepath, sheet = 1, startRow = 4) # note: the first 2 rows have many empty cells and field names are specific in each sheet
names(dat1) <- c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name", "No_Taxfilers",  "Taxfilers_0_24_Percent",  "Taxfilers_25_44_Percent", "Taxfilers_45_64_Percent", "Taxfilers_65Plus_Percent", "Taxfilers_Average_Age",	"Taxfilers_Female_Percent", "Taxfilers_Married_Percent", "Taxfilers_Appt_Percent",	"No_All_Persons",  "Persons_0_24_Percent",	"Persons_25_44_Percent", "Persons_45_64_Percent", "Persons_56Plus_Percent",	"Persons_Average_Age", "Persons_Female_Percent", "Persons_Married_Percent", "Persons_Appt_Percent",	"No_Total_Income", "Percent_Total_Income_15K", "Percent_Total_Income_25K", "Percent_Total_Income_35K", "Percent_Total_Income_50K", "Percent_Total_Income_75K", "Percent_Total_Income_100K",	"Total_Income_Median_Males", "Total_Income_Median_Females", "Total_Income_Median",	"Total_Income_Median_Cdn_Index",	"Total_Income_Median_Prov_Index",	"Employment_Income",	"EI_Female_Percent",	"EI_Percent",	"Median_EI_Males", "Median_EI_Females", "Total_Median_EI",	"No_CCTB", 	"CCTB_Dollars_000")
dat1 <- na.omit(dat1)


###################################################
### Using readxl to avoid using MA Excel to manually
### open and change .xls to .xlxs formats
###################################################

library(dplyr)
library(stringr)
library(here)
library(readxl)

# Set file name, folder and path at top so you only have to change it in one place
filename <- "2015_IND_Tables 1_to_13_Canada.xls"
filefolder <- "Data/ind"
filepath <- here(filefolder, filename)

# Get sheet names and positions from .xls file
sheets <- excel_sheets(filepath)

# load tax data for individuals (per year) from multiple xls sheets
# method using pre-determined and manually scribed column names and number of rows to skip

#read sheet 1 (1)
sheet1names <- c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name", "No_Taxfilers",  "Taxfilers_0_24_Percent",  "Taxfilers_25_44_Percent", "Taxfilers_45_64_Percent", "Taxfilers_65Plus_Percent", "Taxfilers_Average_Age",	"Taxfilers_Female_Percent", "Taxfilers_Married_Percent", "Taxfilers_Appt_Percent",	"No_All_Persons",  "Persons_0_24_Percent",	"Persons_25_44_Percent", "Persons_45_64_Percent", "Persons_56Plus_Percent",	"Persons_Average_Age", "Persons_Female_Percent", "Persons_Married_Percent", "Persons_Appt_Percent",	"No_Total_Income", "Percent_Total_Income_15K", "Percent_Total_Income_25K", "Percent_Total_Income_35K", "Percent_Total_Income_50K", "Percent_Total_Income_75K", "Percent_Total_Income_100K",	"Total_Income_Median_Males", "Total_Income_Median_Females", "Total_Income_Median",	"Total_Income_Median_Cdn_Index",	"Total_Income_Median_Prov_Index",	"Employment_Income",	"EI_Female_Percent",	"EI_Percent",	"Median_EI_Males", "Median_EI_Females", "Total_Median_EI",	"No_CCTB", 	"CCTB_Dollars_000")
sheet1 <- read_excel(filepath, sheet = sheets[1], skip = 4, col_names = sheet1names) %>%
  filter_all(any_vars(!is.na(.)))

#read sheet 2 (2)
sheet2names <- c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"Single_Males",	"Single_Females",	"Single_Total",	"Married_Males",	"Married_Females",	"Married_Total",	"Common_Law_Males",	"Common_Law_Females", "Common_Law_Total",	"Separated_Divorced_Males",	"Separated_Divorced_Females",	"Separated_Divorced_Total",	"Widower_Males"	,"Widow_Females",	"Widow_Total"	,"Total_Males"	,"Total_Females"	,"Total",	"Males_Age_0_14",	"Males_Percent_0_14",	"Females_Age_0_14",	"Females_Percent_0_14",	"Total_Age_0_14"	,"Total_Percent_0_14",	"Males_Age_15_19",	"Males_Percent_15_19",	"Females_Age_15_19",	"Females_Percent_15_19",	"Total_Age_15_19",	"Total_Percent_15_19",	"Males_Age_20_24"	,"Males_Percent_20_24"	,"Females_Age_20_24",	"Females_Percent_20_24",	"Total_Age_20_24", "Total_Percent_20_24",	"Males_Age_25_29",	"Males_Percent_25_29",	"Females_Age_25_29",	"Females_Percent_25_29",	"Total_Age_25_29",	"Total_Percent_25_29",	"Males_Age_30_34",	"Males_Percent_30_34",	"Females_Age_30_34",	"Females_Percent_30_34",	"Total_Age_30_34",	"Total_Percent_30_34",	"Males_Age_35_39",	"Males_Percent_35_39",	"Females_Age_35_39",	"Females_Percent_35_39",	"Total_Age_35_39",	"Total_Percent_35_39",	"Males_Age_40_44",	"Males_Percent_40_44",	"Females_Age_40_44",	"Females_Percent_40_44",	"Total_Age_40_44",	"Total_Percent_40_44",	"Males_Age_45_49",	"Males_Percent_45_49",	"Females_Age_45_49", "Females_Percent_45_49",	"Total_Age_45_49",	"Total_Percent_45_49",	"Males_Age_50_54",	"Males_Percent_50_54",	"Females_Age_50_54",	"Females_Percent_50_54",	"Total_Age_50_54",	"Total_Percent_50_54",	"Males_Age_55_59",	"Males_Percent_55_59",	"Females_Age_55_59",	"Females_Percent_55_59",	"Total_Age_55_59",	"Total_Percent_55_59",	"Males_Age_60_64",	"Males_Percent_60_64",	"Females_Age_60_64",	"Females_Percent_60_64",	"Total_Age_60_64",	"Total_Percent_60_64",	"Males_Age_65_74",	"Males_Percent_65_74",	"Females_Age_65_74",	"Females_Percent_65_74",	"Total_Age_65_74",	"Total_Percent_65_74",	"Males_Age_75P",	"Males_Percent_75P",	"Females_Age_75P",	"Females_Percent_75P",	"Total_Age_75P",	"Total_Percent_75P",	"Total_Males",	"Total_Percent_Males", "Total_Females", "Total_Percent_Females",	"Total",	"Percent_Total",	"Average_Age")
sheet2 <- read_excel(filepath, sheet = sheets[2], skip = 4, col_names = sheet2names) %>%
  filter_all(any_vars(!is.na(.)))

#read sheet 3A (3)
sheet3Anames <- c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"M_0_years",	"M_1_year",	"M_2_years",	"M_3_years",	"M_4_years",	"M_5_years",	"M_6_years",	"M_7_years",	"M_8_years",	"M_9_years",	"M_10_years",	"M_11_years",	"M_12_years",	"M_13_years",	"M_14_years",	"M_15_years",	"M_16_years",	"M_17_years",	"M_18_years",	"M_19_years",	"M_20_years",	"M_21_years",	"M_22_years",	"M_23_years",	"M_24_years",	"M_25_years",	"M_26_years",	"M_27_years",	"M_28_years",	"M_29_years",	"M_30_years",	"M_31_years",	"M_32_years",	"M_33_years",	"M_34_years",	"M_35_years",	"M_36_years",	"M_37_years",	"M_38_years",	"M_39_years",	"M_40_years",	"M_41_years",	"M_42_years",	"M_43_years",	"M_44_years",	"M_45_years",	"M_46_years",	"M_47_years",	"M_48_years",	"M_49_years",	"M_50_years",	"M_51_years",	"M_52_years",	"M_53_years",	"M_54_years",	"M_55_years",	"M_56_years",	"M_57_years",	"M_58_years",	"M_59_years",	"M_60_years",	"M_61_years",	"M_62_years",	"M_63_years",	"M_64_years",	"M_65_years",	"M_66_years",	"M_67_years",	"M_68_years",	"M_69_years",	"M_70_years",	"M_71_years",	"M_72_years",	"M_73_years",	"M_74_years",	"M_75_years",	"M_76_years",	"M_77_years",	"M_78_years",	"M_79_years",	"M_80_years",	"M_81_years",	"M_82_years",	"M_83_years",	"M_84_years",	"M_85_years",	"M_86_years",	"M_87_years",	"M_88_years",	"M_89_years",	"M_90_years",	"M_91_years",	"M_92_years",	"M_93_years",	"M_94_years",	"M_95_years",	"M_96_years",	"M_97_years",	"M_98_years",	"M_99_years",	"M_100P_years",	"M_Total")
sheet3A <- read_excel(filepath, sheet = sheets[3], skip = 3, col_names = sheet3Anames) %>%
  filter_all(any_vars(!is.na(.)))


#################
#### clean ######
#################

dat1 %>% filter(Geo_Level == 11 | Geo_Level == 12)
foo <- dat1 %>% filter(!str_detect(Postal_Area, '^V|^9'))

dat1.new <- subset(dat1[dat1$Geo_Level == "11" | dat1$Geo_Level == "12",])
dat2.new <- subset(dat1[dat1$Place_Name == "ABBOTSFORD - MISSION" | dat1$Place_Name == "CHILLIWACK" | dat1$Place_Name == "KAMLOOPS" | dat1$Place_Name == "KELOWNA" | dat1$Place_Name == "PRINCE GEORGE" | dat1$Place_Name == "VANCOUVER" | dat1$Place_Name == "VICTORIA" | dat1$Place_Name ==  "VANCOUVER ISLAND AND COAST" | dat1$Place_Name =="VANCOUVER CENTRE" | dat1$Place_Name == "VANCOUVER EAST" | dat1$Place_Name == "VANCOUVER GRANVILLE" | dat1$Place_Name == "VANCOUVER KINGSWAY" | dat1$Place_Name ==  "VANCOUVER QUADRA" | dat1$Place_Name == "VANCOUVER SOUTH", ])
dat3.new <-subset(dat1, grepl("^V", Postal_Area))
dat4.new <-subset(dat1, grepl("^9", Postal_Area))

df <- rbind(dat1.new, dat2.new, dat3.new, dat4.new)

unique(df)
duplicated(df)
df[duplicated(df),]



###########################
##### Alternative approach
###########################

library(dplyr)
library(readxl)
library(purrr)
library(readr)


read_then_csv_ind <- function(sheet, skip, col_names, path) {
  
###note colnames need to be fixed for B and C sheets####
  meta <- tribble(
    ~sheetno, ~skiprow, ~sheetcolumnnames,
    "1", "4", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name", "No_Taxfilers",  "Taxfilers_0_24_Percent",  "Taxfilers_25_44_Percent", "Taxfilers_45_64_Percent", "Taxfilers_65Plus_Percent", "Taxfilers_Average_Age",	"Taxfilers_Female_Percent", "Taxfilers_Married_Percent", "Taxfilers_Appt_Percent",	"No_All_Persons",  "Persons_0_24_Percent",	"Persons_25_44_Percent", "Persons_45_64_Percent", "Persons_56Plus_Percent",	"Persons_Average_Age", "Persons_Female_Percent", "Persons_Married_Percent", "Persons_Appt_Percent",	"No_Total_Income", "Percent_Total_Income_15K", "Percent_Total_Income_25K", "Percent_Total_Income_35K", "Percent_Total_Income_50K", "Percent_Total_Income_75K", "Percent_Total_Income_100K",	"Total_Income_Median_Males", "Total_Income_Median_Females", "Total_Income_Median",	"Total_Income_Median_Cdn_Index",	"Total_Income_Median_Prov_Index",	"Employment_Income",	"EI_Female_Percent",	"EI_Percent",	"Median_EI_Males", "Median_EI_Females", "Total_Median_EI",	"No_CCTB", 	"CCTB_Dollars_000"),
    "2", "4", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"Single_Males",	"Single_Females",	"Single_Total",	"Married_Males",	"Married_Females",	"Married_Total",	"Common_Law_Males",	"Common_Law_Females", "Common_Law_Total",	"Separated_Divorced_Males",	"Separated_Divorced_Females",	"Separated_Divorced_Total",	"Widower_Males"	,"Widow_Females",	"Widow_Total"	,"Total_Males"	,"Total_Females"	,"Total",	"Males_Age_0_14",	"Males_Percent_0_14",	"Females_Age_0_14",	"Females_Percent_0_14",	"Total_Age_0_14"	,"Total_Percent_0_14",	"Males_Age_15_19",	"Males_Percent_15_19",	"Females_Age_15_19",	"Females_Percent_15_19",	"Total_Age_15_19",	"Total_Percent_15_19",	"Males_Age_20_24"	,"Males_Percent_20_24"	,"Females_Age_20_24",	"Females_Percent_20_24",	"Total_Age_20_24", "Total_Percent_20_24",	"Males_Age_25_29",	"Males_Percent_25_29",	"Females_Age_25_29",	"Females_Percent_25_29",	"Total_Age_25_29",	"Total_Percent_25_29",	"Males_Age_30_34",	"Males_Percent_30_34",	"Females_Age_30_34",	"Females_Percent_30_34",	"Total_Age_30_34",	"Total_Percent_30_34",	"Males_Age_35_39",	"Males_Percent_35_39",	"Females_Age_35_39",	"Females_Percent_35_39",	"Total_Age_35_39",	"Total_Percent_35_39",	"Males_Age_40_44",	"Males_Percent_40_44",	"Females_Age_40_44",	"Females_Percent_40_44",	"Total_Age_40_44",	"Total_Percent_40_44",	"Males_Age_45_49",	"Males_Percent_45_49",	"Females_Age_45_49", "Females_Percent_45_49",	"Total_Age_45_49",	"Total_Percent_45_49",	"Males_Age_50_54",	"Males_Percent_50_54",	"Females_Age_50_54",	"Females_Percent_50_54",	"Total_Age_50_54",	"Total_Percent_50_54",	"Males_Age_55_59",	"Males_Percent_55_59",	"Females_Age_55_59",	"Females_Percent_55_59",	"Total_Age_55_59",	"Total_Percent_55_59",	"Males_Age_60_64",	"Males_Percent_60_64",	"Females_Age_60_64",	"Females_Percent_60_64",	"Total_Age_60_64",	"Total_Percent_60_64",	"Males_Age_65_74",	"Males_Percent_65_74",	"Females_Age_65_74",	"Females_Percent_65_74",	"Total_Age_65_74",	"Total_Percent_65_74",	"Males_Age_75P",	"Males_Percent_75P",	"Females_Age_75P",	"Females_Percent_75P",	"Total_Age_75P",	"Total_Percent_75P",	"Total_Males",	"Total_Percent_Males", "Total_Females", "Total_Percent_Females",	"Total",	"Percent_Total",	"Average_Age"),
    "3A", "3", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"M_0_years",	"M_1_year",	"M_2_years",	"M_3_years",	"M_4_years",	"M_5_years",	"M_6_years",	"M_7_years",	"M_8_years",	"M_9_years",	"M_10_years",	"M_11_years",	"M_12_years",	"M_13_years",	"M_14_years",	"M_15_years",	"M_16_years",	"M_17_years",	"M_18_years",	"M_19_years",	"M_20_years",	"M_21_years",	"M_22_years",	"M_23_years",	"M_24_years",	"M_25_years",	"M_26_years",	"M_27_years",	"M_28_years",	"M_29_years",	"M_30_years",	"M_31_years",	"M_32_years",	"M_33_years",	"M_34_years",	"M_35_years",	"M_36_years",	"M_37_years",	"M_38_years",	"M_39_years",	"M_40_years",	"M_41_years",	"M_42_years",	"M_43_years",	"M_44_years",	"M_45_years",	"M_46_years",	"M_47_years",	"M_48_years",	"M_49_years",	"M_50_years",	"M_51_years",	"M_52_years",	"M_53_years",	"M_54_years",	"M_55_years",	"M_56_years",	"M_57_years",	"M_58_years",	"M_59_years",	"M_60_years",	"M_61_years",	"M_62_years",	"M_63_years",	"M_64_years",	"M_65_years",	"M_66_years",	"M_67_years",	"M_68_years",	"M_69_years",	"M_70_years",	"M_71_years",	"M_72_years",	"M_73_years",	"M_74_years",	"M_75_years",	"M_76_years",	"M_77_years",	"M_78_years",	"M_79_years",	"M_80_years",	"M_81_years",	"M_82_years",	"M_83_years",	"M_84_years",	"M_85_years",	"M_86_years",	"M_87_years",	"M_88_years",	"M_89_years",	"M_90_years",	"M_91_years",	"M_92_years",	"M_93_years",	"M_94_years",	"M_95_years",	"M_96_years",	"M_97_years",	"M_98_years",	"M_99_years",	"M_100P_years",	"M_Total"),
    "3B", "3", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"F_0_years",	"F_1_year",	"F_2_years",	"F_3_years",	"F_4_years",	"F_5_years",	"F_6_years",	"F_7_years",	"F_8_years",	"F_9_years",	"F_10_years",	"F_11_years",	"F_12_years",	"F_13_years",	"F_14_years",	"F_15_years",	"F_16_years",	"F_17_years",	"F_18_years",	"F_19_years",	"F_20_years",	"F_21_years",	"F_22_years",	"F_23_years",	"F_24_years",	"F_25_years",	"F_26_years",	"F_27_years",	"F_28_years",	"F_29_years",	"F_30_years",	"F_31_years",	"F_32_years",	"F_33_years",	"F_34_years",	"F_35_years",	"F_36_years",	"F_37_years",	"F_38_years",	"F_39_years",	"F_40_years",	"F_41_years",	"F_42_years",	"F_43_years",	"F_44_years",	"F_45_years",	"F_46_years",	"F_47_years",	"F_48_years",	"F_49_years",	"F_50_years",	"F_51_years",	"F_52_years",	"F_53_years",	"F_54_years",	"F_55_years",	"F_56_years",	"F_57_years",	"F_58_years",	"F_59_years",	"F_60_years",	"F_61_years",	"F_62_years",	"F_63_years",	"F_64_years",	"F_65_years",	"F_66_years",	"F_67_years",	"F_68_years",	"F_69_years",	"F_70_years",	"F_71_years",	"F_72_years",	"F_73_years",	"F_74_years",	"F_75_years",	"F_76_years",	"F_77_years",	"F_78_years",	"F_79_years",	"F_80_years",	"F_81_years",	"F_82_years",	"F_83_years",	"F_84_years",	"F_85_years",	"F_86_years",	"F_87_years",	"F_88_years",	"F_89_years",	"F_90_years",	"F_91_years",	"F_92_years",	"F_93_years",	"F_94_years",	"F_95_years",	"F_96_years",	"F_97_years",	"F_98_years",	"F_99_years",	"F_100P_years",	"F_Total"),
    "3C", "3", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"All_0_years",	"All_1_year",	"All_2_years",	"All_3_years",	"All_4_years",	"All_5_years",	"All_6_years",	"All_7_years",	"All_8_years",	"All_9_years",	"All_10_years",	"All_11_years",	"All_12_years",	"All_13_years",	"All_14_years",	"All_15_years",	"All_16_years",	"All_17_years",	"All_18_years",	"All_19_years",	"All_20_years",	"All_21_years",	"All_22_years",	"All_23_years",	"All_24_years",	"All_25_years",	"All_26_years",	"All_27_years",	"All_28_years",	"All_29_years",	"All_30_years",	"All_31_years",	"All_32_years",	"All_33_years",	"All_34_years",	"All_35_years",	"All_36_years",	"All_37_years",	"All_38_years",	"All_39_years",	"All_40_years",	"All_41_years",	"All_42_years",	"All_43_years",	"All_44_years",	"All_45_years",	"All_46_years",	"All_47_years",	"All_48_years",	"All_49_years",	"All_50_years",	"All_51_years",	"All_52_years",	"All_53_years",	"All_54_years",	"All_55_years",	"All_56_years",	"All_57_years",	"All_58_years",	"All_59_years",	"All_60_years",	"All_61_years",	"All_62_years",	"All_63_years",	"All_64_years",	"All_65_years",	"All_66_years",	"All_67_years",	"All_68_years",	"All_69_years",	"All_70_years",	"All_71_years",	"All_72_years",	"All_73_years",	"All_74_years",	"All_75_years",	"All_76_years",	"All_77_years",	"All_78_years",	"All_79_years",	"All_80_years",	"All_81_years",	"All_82_years",	"All_83_years",	"All_84_years",	"All_85_years",	"All_86_years",	"All_87_years",	"All_88_years",	"All_89_years",	"All_90_years",	"All_91_years",	"All_92_years",	"All_93_years",	"All_94_years",	"All_95_years",	"All_96_years",	"All_97_years",	"All_98_years",	"All_99_years",	"All_100P_years",	"All_Total"),
    "4", "4", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"EI_Males",	"EI_Females",	"EI_Total",	"EI_Males_Dollars_000",	"EI_Females_Dollars_000",	"EI_Total_Dollars_000",	"Total_Wages_Salaries_Commissions_Males",	"Total_Wages_Salaries_Commissions_Females",	"Total_Wages_Salaries_Commissions",	"Total_Wages_Salaries_Commissions_Males_Dollar_000",	"Total_Wages_Salaries_Commissions_Females_Dollar_000",	"Total_Wages_Salaries_Commissions_Total_Dollar_000",	"Self_Employment_Males",	"Self_Employment_Females",	"Self_Employment_Total",	"Self_Employment_Males_Dollars_000",	"Self_Employment_Females_Dollars_000",	"Self_Employment_Total_Dollars_000",	"Investments_Males",	"Investments_Females",	"Investments_Total",	"Investments_Males_Dollars_000",	"Investments_Females_Dollars_000",	"Investments_Total_Dollars_000",	"Government_Transfers_Males",	"Government_Transfers_Females",	"Government_Transfers_Total",	"Government_Transfers_Males_Dollar_000",	"Government_Transfers_Females_Dollar_000",	"Government_Transfers_Total_Dollar_000",	"EI_Males_No",	"EI_Females_No",	"EI_Total_No",	"EI_Males_Dollar_000",	"EI_Females_Dollar_000",	"EI_Total_Dollar_000",	"OAS_Net_Federal_Supp_Males",	"OAS_Net_Federal_Supp_Females",	"OAS_Net_Federal_Supp_Total",	"OAS_Net_Federal_Supp_Males_Dollar_000",	"OAS_Net_Federal_Supp_Females_Dollar_000",	"OAS_Net_Federal_Supp_Total_Dollar_000",	"CPP_QPP_Males", "CPP_QPP_Females",	"CPP_QPP_Total",	"Total_Males_Dollar_000",	"Total_Females_Dollar_000",	"Total_Total_Dollar_000",	"CCTB_Males",	"CCTB_Females",	"CCTB_Total",	"CCTB_Males_Dollar_000",	"CCTB_Females_Dollar_000",	"CCTB_Total_Dollar_000",	"GST_HST_Credit_Males",	"GST_HST_Credit_Females",	"GST_HST_Credit_Total",	"GST_HST_Credit_Males_Dollar_000",	"GST_HST_Credit_Females_Dollar_000",	"GST_HST_Credit_Total_Dollar_000",	"Workers_Compensation_Males",	"Workers_Compensation_Females",	"Workers_Compensation_Total",	"Workers_Compensation_Males_Dollar_000",	"Workers_Compensation_Females_Dollar_000",	"Workers_Compensation_Total_Dollar_000",	"Social_Assistance_Males",	"Social_Assistance_Females",	"Social_Assistance_Total",	"Social_Assistance_Males_Dollar_000",	"Social_Assistance_Females_Dollar_000",	"Social_Assistance_Total_Dollar_000",	"Provincial_Tax_Credits_Family_Benefits_Males",	"Provincial_Tax_Credits_Family_Benefits_Females",	"Provincial_Tax_Credits_Family_Benefits_Total",	"Provincial_Tax_Credits_Family_Benefits_Males_Dollar_000",	"Provincial_Tax_Credits_Family_Benefits_Females_Dollar_000",	"Provincial_Tax_Credits_Family_Benefits_Total_Dollar_000",	"Other_Government_Transfers_Males",	"Other_Government_Transfers_Females",	"Other_Government_Transfers_Total",	"Other_Government_Transfers_Males",	"Other_Government_Transfers_Females",	"Other_Government_Transfers_Total",	"Private_Pensions_Males",	"Private_Pensions_Females",	"Private_Pensions_Total",	"Private_Pensions_Males_Dollar_000",	"Private_Pensions_Females_Dollar_000",	"Private_Pensions_Total_Dollar_000",	"RRSP_Males",	"RRSP_Females",	"RRSP_Total",	"RRSP_Males_Dollar_000",	"RRSP_Females_Dollar_000",	"RRSP_Total_Dollar_000",	"Other_Income_Males",	"Other_Income_Females",	"Other_Income_Total",	"Other_Income_Males_Dollar_000",	"Other_Income_Females_Dollar_000",	"Other_Income_Total_Dollar_000",	"Total_Income_Males",	"Total_Income_Females",	"Total_Income_Total",	"Total_Income_Males_Dollar_000",	"Total_Income_Females_Dollar_000",	"Total_Income_Total_Dollar_000"),
    "5A", "4", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"Male_Income_Age_0_24_Less5K",	"Male_Income_Age_0_24_5K",	"Male_Income_Age_0_24_10K",	"Male_Income_Age_0_24_15K",	"Male_Income_Age_0_24_20K",	"Male_Income_Age_0_24_25K",	"Male_Income_Age_0_24_35K",	"Male_Income_Age_0_24_50K",	"Male_Income_Age_0_24_75K",	"Male_Income_Age_0_24_100K",	"Male_Income_Age_0_24_150K",	"Male_Income_Age_0_24_200K",	"Male_Income_Age_0_24_250K",	"Male_Income_Age_0_24_Total",	"Male_Income_Age_25_34_Less5K",	"Male_Income_Age_25_34_5K",	"Male_Income_Age_25_34_10K",	"Male_Income_Age_25_34_15K",	"Male_Income_Age_25_34_20K",	"Male_Income_Age_25_34_25K",	"Male_Income_Age_25_34_35K",	"Male_Income_Age_25_34_50K",	"Male_Income_Age_25_34_75K",	"Male_Income_Age_25_34_100K",	"Male_Income_Age_25_34_150K",	"Male_Income_Age_25_34_200K",	"Male_Income_Age_25_34_250K",	"Male_Income_Age_25_34_Total",	"Male_Income_Age_35_44_Less5K",	"Male_Income_Age_35_44_5K",	"Male_Income_Age_35_44_10K",	"Male_Income_Age_35_44_15K",	"Male_Income_Age_35_44_20K",	"Male_Income_Age_35_44_25K",	"Male_Income_Age_35_44_35K",	"Male_Income_Age_35_44_50K",	"Male_Income_Age_35_44_75K",	"Male_Income_Age_35_44_100K",	"Male_Income_Age_35_44_150K",	"Male_Income_Age_35_44_200K",	"Male_Income_Age_35_44_250K",	"Male_Income_Age_35_44_Total",	"Male_Income_Age_45_54_Less5K",	"Male_Income_Age_45_54_5K",	"Male_Income_Age_45_54_10K",	"Male_Income_Age_45_54_15K",	"Male_Income_Age_45_54_20K",	"Male_Income_Age_45_54_25K",	"Male_Income_Age_45_54_35K",	"Male_Income_Age_45_54_50K",	"Male_Income_Age_45_54_75K",	"Male_Income_Age_45_54_100K",	"Male_Income_Age_45_54_150K",	"Male_Income_Age_45_54_200K",	"Male_Income_Age_45_54_250K",	"Male_Income_Age_45_54_Total",	"Male_Income_Age_55_64_Less5K",	"Male_Income_Age_55_64_5K",	"Male_Income_Age_55_64_10K",	"Male_Income_Age_55_64_15K",	"Male_Income_Age_55_64_20K",	"Male_Income_Age_55_64_25K",	"Male_Income_Age_55_64_35K",	"Male_Income_Age_55_64_50K",	"Male_Income_Age_55_64_75K",	"Male_Income_Age_55_64_100K",	"Male_Income_Age_55_64_150K",	"Male_Income_Age_55_64_200K",	"Male_Income_Age_55_64_250K",	"Male_Income_Age_55_64_Total",	"Male_Income_Age_65P_Less5K",	"Male_Income_Age_65P_5K",	"Male_Income_Age_65P_10K",	"Male_Income_Age_65P_15K",	"Male_Income_Age_65P_20K",	"Male_Income_Age_65P_25K",	"Male_Income_Age_65P_35K",	"Male_Income_Age_65P_50K",	"Male_Income_Age_65P_75K",	"Male_Income_Age_65P_100K",	"Male_Income_Age_65P_150K",	"Male_Income_Age_65P_200K",	"Male_Income_Age_65P_250K",	"Male_Income_Age_65P_Total",	"Male_Income_Age_65P_Less5K",	"Male_Income_Age_0_24_5K",	"Male_Income_Age_0_24_10K",	"Male_Income_Age_0_24_15K",	"Male_Income_Age_0_24_20K",	"Male_Income_Age_0_24_25K",	"Male_Income_Age_0_24_35K",	"Male_Income_Age_0_24_50K",	"Male_Income_Age_0_24_75K",	"Male_Income_Age_0_24_100K",	"Male_Income_Age_0_24_150K",	"Male_Income_Age_0_24_200K",	"Male_Income_Age_0_24_250K",	"Male_Income_Age_0_24_Total", "Male_2015_Median"),
    "5B", "4", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"Male_Income_Age_0_24_Less5K",	"Male_Income_Age_0_24_5K",	"Male_Income_Age_0_24_10K",	"Male_Income_Age_0_24_15K",	"Male_Income_Age_0_24_20K",	"Male_Income_Age_0_24_25K",	"Male_Income_Age_0_24_35K",	"Male_Income_Age_0_24_50K",	"Male_Income_Age_0_24_75K",	"Male_Income_Age_0_24_100K",	"Male_Income_Age_0_24_150K",	"Male_Income_Age_0_24_200K",	"Male_Income_Age_0_24_250K",	"Male_Income_Age_0_24_Total",	"Male_Income_Age_25_34_Less5K",	"Male_Income_Age_25_34_5K",	"Male_Income_Age_25_34_10K",	"Male_Income_Age_25_34_15K",	"Male_Income_Age_25_34_20K",	"Male_Income_Age_25_34_25K",	"Male_Income_Age_25_34_35K",	"Male_Income_Age_25_34_50K",	"Male_Income_Age_25_34_75K",	"Male_Income_Age_25_34_100K",	"Male_Income_Age_25_34_150K",	"Male_Income_Age_25_34_200K",	"Male_Income_Age_25_34_250K",	"Male_Income_Age_25_34_Total",	"Male_Income_Age_35_44_Less5K",	"Male_Income_Age_35_44_5K",	"Male_Income_Age_35_44_10K",	"Male_Income_Age_35_44_15K",	"Male_Income_Age_35_44_20K",	"Male_Income_Age_35_44_25K",	"Male_Income_Age_35_44_35K",	"Male_Income_Age_35_44_50K",	"Male_Income_Age_35_44_75K",	"Male_Income_Age_35_44_100K",	"Male_Income_Age_35_44_150K",	"Male_Income_Age_35_44_200K",	"Male_Income_Age_35_44_250K",	"Male_Income_Age_35_44_Total",	"Male_Income_Age_45_54_Less5K",	"Male_Income_Age_45_54_5K",	"Male_Income_Age_45_54_10K",	"Male_Income_Age_45_54_15K",	"Male_Income_Age_45_54_20K",	"Male_Income_Age_45_54_25K",	"Male_Income_Age_45_54_35K",	"Male_Income_Age_45_54_50K",	"Male_Income_Age_45_54_75K",	"Male_Income_Age_45_54_100K",	"Male_Income_Age_45_54_150K",	"Male_Income_Age_45_54_200K",	"Male_Income_Age_45_54_250K",	"Male_Income_Age_45_54_Total",	"Male_Income_Age_55_64_Less5K",	"Male_Income_Age_55_64_5K",	"Male_Income_Age_55_64_10K",	"Male_Income_Age_55_64_15K",	"Male_Income_Age_55_64_20K",	"Male_Income_Age_55_64_25K",	"Male_Income_Age_55_64_35K",	"Male_Income_Age_55_64_50K",	"Male_Income_Age_55_64_75K",	"Male_Income_Age_55_64_100K",	"Male_Income_Age_55_64_150K",	"Male_Income_Age_55_64_200K",	"Male_Income_Age_55_64_250K",	"Male_Income_Age_55_64_Total",	"Male_Income_Age_65P_Less5K",	"Male_Income_Age_65P_5K",	"Male_Income_Age_65P_10K",	"Male_Income_Age_65P_15K",	"Male_Income_Age_65P_20K",	"Male_Income_Age_65P_25K",	"Male_Income_Age_65P_35K",	"Male_Income_Age_65P_50K",	"Male_Income_Age_65P_75K",	"Male_Income_Age_65P_100K",	"Male_Income_Age_65P_150K",	"Male_Income_Age_65P_200K",	"Male_Income_Age_65P_250K",	"Male_Income_Age_65P_Total",	"Male_Income_Age_65P_Less5K",	"Male_Income_Age_0_24_5K",	"Male_Income_Age_0_24_10K",	"Male_Income_Age_0_24_15K",	"Male_Income_Age_0_24_20K",	"Male_Income_Age_0_24_25K",	"Male_Income_Age_0_24_35K",	"Male_Income_Age_0_24_50K",	"Male_Income_Age_0_24_75K",	"Male_Income_Age_0_24_100K",	"Male_Income_Age_0_24_150K",	"Male_Income_Age_0_24_200K",	"Male_Income_Age_0_24_250K",	"Male_Income_Age_0_24_Total", "Male_2015_Median"),
    "5C", "4", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"Male_Income_Age_0_24_Less5K",	"Male_Income_Age_0_24_5K",	"Male_Income_Age_0_24_10K",	"Male_Income_Age_0_24_15K",	"Male_Income_Age_0_24_20K",	"Male_Income_Age_0_24_25K",	"Male_Income_Age_0_24_35K",	"Male_Income_Age_0_24_50K",	"Male_Income_Age_0_24_75K",	"Male_Income_Age_0_24_100K",	"Male_Income_Age_0_24_150K",	"Male_Income_Age_0_24_200K",	"Male_Income_Age_0_24_250K",	"Male_Income_Age_0_24_Total",	"Male_Income_Age_25_34_Less5K",	"Male_Income_Age_25_34_5K",	"Male_Income_Age_25_34_10K",	"Male_Income_Age_25_34_15K",	"Male_Income_Age_25_34_20K",	"Male_Income_Age_25_34_25K",	"Male_Income_Age_25_34_35K",	"Male_Income_Age_25_34_50K",	"Male_Income_Age_25_34_75K",	"Male_Income_Age_25_34_100K",	"Male_Income_Age_25_34_150K",	"Male_Income_Age_25_34_200K",	"Male_Income_Age_25_34_250K",	"Male_Income_Age_25_34_Total",	"Male_Income_Age_35_44_Less5K",	"Male_Income_Age_35_44_5K",	"Male_Income_Age_35_44_10K",	"Male_Income_Age_35_44_15K",	"Male_Income_Age_35_44_20K",	"Male_Income_Age_35_44_25K",	"Male_Income_Age_35_44_35K",	"Male_Income_Age_35_44_50K",	"Male_Income_Age_35_44_75K",	"Male_Income_Age_35_44_100K",	"Male_Income_Age_35_44_150K",	"Male_Income_Age_35_44_200K",	"Male_Income_Age_35_44_250K",	"Male_Income_Age_35_44_Total",	"Male_Income_Age_45_54_Less5K",	"Male_Income_Age_45_54_5K",	"Male_Income_Age_45_54_10K",	"Male_Income_Age_45_54_15K",	"Male_Income_Age_45_54_20K",	"Male_Income_Age_45_54_25K",	"Male_Income_Age_45_54_35K",	"Male_Income_Age_45_54_50K",	"Male_Income_Age_45_54_75K",	"Male_Income_Age_45_54_100K",	"Male_Income_Age_45_54_150K",	"Male_Income_Age_45_54_200K",	"Male_Income_Age_45_54_250K",	"Male_Income_Age_45_54_Total",	"Male_Income_Age_55_64_Less5K",	"Male_Income_Age_55_64_5K",	"Male_Income_Age_55_64_10K",	"Male_Income_Age_55_64_15K",	"Male_Income_Age_55_64_20K",	"Male_Income_Age_55_64_25K",	"Male_Income_Age_55_64_35K",	"Male_Income_Age_55_64_50K",	"Male_Income_Age_55_64_75K",	"Male_Income_Age_55_64_100K",	"Male_Income_Age_55_64_150K",	"Male_Income_Age_55_64_200K",	"Male_Income_Age_55_64_250K",	"Male_Income_Age_55_64_Total",	"Male_Income_Age_65P_Less5K",	"Male_Income_Age_65P_5K",	"Male_Income_Age_65P_10K",	"Male_Income_Age_65P_15K",	"Male_Income_Age_65P_20K",	"Male_Income_Age_65P_25K",	"Male_Income_Age_65P_35K",	"Male_Income_Age_65P_50K",	"Male_Income_Age_65P_75K",	"Male_Income_Age_65P_100K",	"Male_Income_Age_65P_150K",	"Male_Income_Age_65P_200K",	"Male_Income_Age_65P_250K",	"Male_Income_Age_65P_Total",	"Male_Income_Age_65P_Less5K",	"Male_Income_Age_0_24_5K",	"Male_Income_Age_0_24_10K",	"Male_Income_Age_0_24_15K",	"Male_Income_Age_0_24_20K",	"Male_Income_Age_0_24_25K",	"Male_Income_Age_0_24_35K",	"Male_Income_Age_0_24_50K",	"Male_Income_Age_0_24_75K",	"Male_Income_Age_0_24_100K",	"Male_Income_Age_0_24_150K",	"Male_Income_Age_0_24_200K",	"Male_Income_Age_0_24_250K",	"Male_Income_Age_0_24_Total", "Male_2015_Median"),
    "6" , "4", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name", "Total_Income_Males",	"Total_Income_Females",	"Total_Income",	"Total_Income_Males_Dollar_000",	"Total_Income_Females_Dollar_000",	"Total_Income_Dollar_000",	"IncomeTax_Males",	"IncomeTax_Femles",	"IncomeTax_Total",	"IncomeTax_Males_Dollar_000",	"IncomeTax_Females_Dollar_000",	"IncomeTax_Dollar_000",	"FederalTax_Males",	"FederalTax_Females",	"FederalTax_Total",	"FederalTax_Males_Dollar_000",	"FederalTax_Females_Dollar_000",	"FederalTax_Total_Dollar_000",	"ProvincialTax_Males",	"ProvincialTax_Females",	"ProvincialTax_Total",	"ProvincialTax_Males_Dollar_000",	"ProvincialTax_Females_Dollar_000",	"ProvincialTax_Total_Dollar_000",	"Qbc_Abatement_Males",	"Qbc_Abatement_Females",	"Qbc_Abatement_Total",	"Qbc_Abatement_Males_Dollar_000",	"Qbc_Abatement_Females_Dollar_000",	"Qbc_Abatement_Total_Dollar_000",	"CapitalGains_Males",	"CapitalGains_Females",	"CapitalGains_Total",	"CapitalGains_Males_Dollar_000",	"CapitalGains_Females_Dollar_000",	"CapitalGains_Total_Dollar_000",	"EI_Premium_Total",	"EI_Premium_Females",	"EI_Premium_Total",	"EI_Premium_Males_Dollar_000",	"EI_Premium_Females_Dollar_000",	"EI_Premium_Total_Dollar_000",	"CPP_QPP_Premium_Total",	"CPP_QPP_Premium_Females",	"CPP_QPP_Premium_Total",	"CPP_QPP_Premium_Males_Dollar_000",	"CPP_QPP_Premium_Females_Dollar_000",	"CPP_QPP_Premium_Total_Dollar_000",	"RPP_Deduction_Total",	"RPP_Deduction_Females",	"RPP_Deduction_Total",	"RPP_Deduction_Males_Dollar_000",	"RPP_Deduction_Females_Dollar_000",	"RPP_Deduction_Total_Dollar_000",	"Union_Professional_Dues_Total",	"Union_Professional_Dues_Females",	"Union_Professional_Dues_Total",	"Union_Professional_Dues_Males_Dollar_000",	"Union_Professional_Dues_Females_Dollar_000",	"Union_Professional_Dues_Total_Dollar_000",	"Emp_Insurance_Benefits_Total",	"Emp_Insurance_Benefits_Females",	"Emp_Insurance_Benefits_Total",	"Emp_Insurance_Benefits_Males_Dollar_000",	"Emp_Insurance_Benefits_Females_Dollar_000",	"Emp_Insurance_Benefits_Total_Dollar_000",	"CPP_QPP_Benefits_Total",	"CPP_QPP_Benefits_Females",	"CPP_QPP_Benefits_Total",	"CPP_QPP_Benefits_Males_Dollar_000",	"CPP_QPP_Benefits_Females_Dollar_000",	"CPP_QPP_Benefits_Total_Dollar_000"),
    "7A", "4", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"Male_Income_Age_0_24_Less5K",	"Male_Income_Age_0_24_5K",	"Male_Income_Age_0_24_10K",	"Male_Income_Age_0_24_15K",	"Male_Income_Age_0_24_20K",	"Male_Income_Age_0_24_25K",	"Male_Income_Age_0_24_35K",	"Male_Income_Age_0_24_50K",	"Male_Income_Age_0_24_75K",	"Male_Income_Age_0_24_100K",	"Male_Income_Age_0_24_150K",	"Male_Income_Age_0_24_200K",	"Male_Income_Age_0_24_250K",	"Male_Income_Age_0_24_Total",	"Male_Income_Age_25_34_Less5K",	"Male_Income_Age_25_34_5K",	"Male_Income_Age_25_34_10K",	"Male_Income_Age_25_34_15K",	"Male_Income_Age_25_34_20K",	"Male_Income_Age_25_34_25K",	"Male_Income_Age_25_34_35K",	"Male_Income_Age_25_34_50K",	"Male_Income_Age_25_34_75K",	"Male_Income_Age_25_34_100K",	"Male_Income_Age_25_34_150K",	"Male_Income_Age_25_34_200K",	"Male_Income_Age_25_34_250K",	"Male_Income_Age_25_34_Total",	"Male_Income_Age_35_44_Less5K",	"Male_Income_Age_35_44_5K",	"Male_Income_Age_35_44_10K",	"Male_Income_Age_35_44_15K",	"Male_Income_Age_35_44_20K",	"Male_Income_Age_35_44_25K",	"Male_Income_Age_35_44_35K",	"Male_Income_Age_35_44_50K",	"Male_Income_Age_35_44_75K",	"Male_Income_Age_35_44_100K",	"Male_Income_Age_35_44_150K",	"Male_Income_Age_35_44_200K",	"Male_Income_Age_35_44_250K",	"Male_Income_Age_35_44_Total",	"Male_Income_Age_45_54_Less5K",	"Male_Income_Age_45_54_5K",	"Male_Income_Age_45_54_10K",	"Male_Income_Age_45_54_15K",	"Male_Income_Age_45_54_20K",	"Male_Income_Age_45_54_25K",	"Male_Income_Age_45_54_35K",	"Male_Income_Age_45_54_50K",	"Male_Income_Age_45_54_75K",	"Male_Income_Age_45_54_100K",	"Male_Income_Age_45_54_150K",	"Male_Income_Age_45_54_200K",	"Male_Income_Age_45_54_250K",	"Male_Income_Age_45_54_Total",	"Male_Income_Age_55_64_Less5K",	"Male_Income_Age_55_64_5K",	"Male_Income_Age_55_64_10K",	"Male_Income_Age_55_64_15K",	"Male_Income_Age_55_64_20K",	"Male_Income_Age_55_64_25K",	"Male_Income_Age_55_64_35K",	"Male_Income_Age_55_64_50K",	"Male_Income_Age_55_64_75K",	"Male_Income_Age_55_64_100K",	"Male_Income_Age_55_64_150K",	"Male_Income_Age_55_64_200K",	"Male_Income_Age_55_64_250K",	"Male_Income_Age_55_64_Total",	"Male_Income_Age_65P_Less5K",	"Male_Income_Age_65P_5K",	"Male_Income_Age_65P_10K",	"Male_Income_Age_65P_15K",	"Male_Income_Age_65P_20K",	"Male_Income_Age_65P_25K",	"Male_Income_Age_65P_35K",	"Male_Income_Age_65P_50K",	"Male_Income_Age_65P_75K",	"Male_Income_Age_65P_100K",	"Male_Income_Age_65P_150K",	"Male_Income_Age_65P_200K",	"Male_Income_Age_65P_250K",	"Male_Income_Age_65P_Total",	"Male_Income_Age_65P_Less5K",	"Male_Income_Age_0_24_5K",	"Male_Income_Age_0_24_10K",	"Male_Income_Age_0_24_15K",	"Male_Income_Age_0_24_20K",	"Male_Income_Age_0_24_25K",	"Male_Income_Age_0_24_35K",	"Male_Income_Age_0_24_50K",	"Male_Income_Age_0_24_75K",	"Male_Income_Age_0_24_100K",	"Male_Income_Age_0_24_150K",	"Male_Income_Age_0_24_200K",	"Male_Income_Age_0_24_250K",	"Male_Income_Age_0_24_Total", "Male_2015_Median"),	
    "7B", "4", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"Male_Income_Age_0_24_Less5K",	"Male_Income_Age_0_24_5K",	"Male_Income_Age_0_24_10K",	"Male_Income_Age_0_24_15K",	"Male_Income_Age_0_24_20K",	"Male_Income_Age_0_24_25K",	"Male_Income_Age_0_24_35K",	"Male_Income_Age_0_24_50K",	"Male_Income_Age_0_24_75K",	"Male_Income_Age_0_24_100K",	"Male_Income_Age_0_24_150K",	"Male_Income_Age_0_24_200K",	"Male_Income_Age_0_24_250K",	"Male_Income_Age_0_24_Total",	"Male_Income_Age_25_34_Less5K",	"Male_Income_Age_25_34_5K",	"Male_Income_Age_25_34_10K",	"Male_Income_Age_25_34_15K",	"Male_Income_Age_25_34_20K",	"Male_Income_Age_25_34_25K",	"Male_Income_Age_25_34_35K",	"Male_Income_Age_25_34_50K",	"Male_Income_Age_25_34_75K",	"Male_Income_Age_25_34_100K",	"Male_Income_Age_25_34_150K",	"Male_Income_Age_25_34_200K",	"Male_Income_Age_25_34_250K",	"Male_Income_Age_25_34_Total",	"Male_Income_Age_35_44_Less5K",	"Male_Income_Age_35_44_5K",	"Male_Income_Age_35_44_10K",	"Male_Income_Age_35_44_15K",	"Male_Income_Age_35_44_20K",	"Male_Income_Age_35_44_25K",	"Male_Income_Age_35_44_35K",	"Male_Income_Age_35_44_50K",	"Male_Income_Age_35_44_75K",	"Male_Income_Age_35_44_100K",	"Male_Income_Age_35_44_150K",	"Male_Income_Age_35_44_200K",	"Male_Income_Age_35_44_250K",	"Male_Income_Age_35_44_Total",	"Male_Income_Age_45_54_Less5K",	"Male_Income_Age_45_54_5K",	"Male_Income_Age_45_54_10K",	"Male_Income_Age_45_54_15K",	"Male_Income_Age_45_54_20K",	"Male_Income_Age_45_54_25K",	"Male_Income_Age_45_54_35K",	"Male_Income_Age_45_54_50K",	"Male_Income_Age_45_54_75K",	"Male_Income_Age_45_54_100K",	"Male_Income_Age_45_54_150K",	"Male_Income_Age_45_54_200K",	"Male_Income_Age_45_54_250K",	"Male_Income_Age_45_54_Total",	"Male_Income_Age_55_64_Less5K",	"Male_Income_Age_55_64_5K",	"Male_Income_Age_55_64_10K",	"Male_Income_Age_55_64_15K",	"Male_Income_Age_55_64_20K",	"Male_Income_Age_55_64_25K",	"Male_Income_Age_55_64_35K",	"Male_Income_Age_55_64_50K",	"Male_Income_Age_55_64_75K",	"Male_Income_Age_55_64_100K",	"Male_Income_Age_55_64_150K",	"Male_Income_Age_55_64_200K",	"Male_Income_Age_55_64_250K",	"Male_Income_Age_55_64_Total",	"Male_Income_Age_65P_Less5K",	"Male_Income_Age_65P_5K",	"Male_Income_Age_65P_10K",	"Male_Income_Age_65P_15K",	"Male_Income_Age_65P_20K",	"Male_Income_Age_65P_25K",	"Male_Income_Age_65P_35K",	"Male_Income_Age_65P_50K",	"Male_Income_Age_65P_75K",	"Male_Income_Age_65P_100K",	"Male_Income_Age_65P_150K",	"Male_Income_Age_65P_200K",	"Male_Income_Age_65P_250K",	"Male_Income_Age_65P_Total",	"Male_Income_Age_65P_Less5K",	"Male_Income_Age_0_24_5K",	"Male_Income_Age_0_24_10K",	"Male_Income_Age_0_24_15K",	"Male_Income_Age_0_24_20K",	"Male_Income_Age_0_24_25K",	"Male_Income_Age_0_24_35K",	"Male_Income_Age_0_24_50K",	"Male_Income_Age_0_24_75K",	"Male_Income_Age_0_24_100K",	"Male_Income_Age_0_24_150K",	"Male_Income_Age_0_24_200K",	"Male_Income_Age_0_24_250K",	"Male_Income_Age_0_24_Total", "Male_2015_Median"),
    "7C", "4", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"Male_Income_Age_0_24_Less5K",	"Male_Income_Age_0_24_5K",	"Male_Income_Age_0_24_10K",	"Male_Income_Age_0_24_15K",	"Male_Income_Age_0_24_20K",	"Male_Income_Age_0_24_25K",	"Male_Income_Age_0_24_35K",	"Male_Income_Age_0_24_50K",	"Male_Income_Age_0_24_75K",	"Male_Income_Age_0_24_100K",	"Male_Income_Age_0_24_150K",	"Male_Income_Age_0_24_200K",	"Male_Income_Age_0_24_250K",	"Male_Income_Age_0_24_Total",	"Male_Income_Age_25_34_Less5K",	"Male_Income_Age_25_34_5K",	"Male_Income_Age_25_34_10K",	"Male_Income_Age_25_34_15K",	"Male_Income_Age_25_34_20K",	"Male_Income_Age_25_34_25K",	"Male_Income_Age_25_34_35K",	"Male_Income_Age_25_34_50K",	"Male_Income_Age_25_34_75K",	"Male_Income_Age_25_34_100K",	"Male_Income_Age_25_34_150K",	"Male_Income_Age_25_34_200K",	"Male_Income_Age_25_34_250K",	"Male_Income_Age_25_34_Total",	"Male_Income_Age_35_44_Less5K",	"Male_Income_Age_35_44_5K",	"Male_Income_Age_35_44_10K",	"Male_Income_Age_35_44_15K",	"Male_Income_Age_35_44_20K",	"Male_Income_Age_35_44_25K",	"Male_Income_Age_35_44_35K",	"Male_Income_Age_35_44_50K",	"Male_Income_Age_35_44_75K",	"Male_Income_Age_35_44_100K",	"Male_Income_Age_35_44_150K",	"Male_Income_Age_35_44_200K",	"Male_Income_Age_35_44_250K",	"Male_Income_Age_35_44_Total",	"Male_Income_Age_45_54_Less5K",	"Male_Income_Age_45_54_5K",	"Male_Income_Age_45_54_10K",	"Male_Income_Age_45_54_15K",	"Male_Income_Age_45_54_20K",	"Male_Income_Age_45_54_25K",	"Male_Income_Age_45_54_35K",	"Male_Income_Age_45_54_50K",	"Male_Income_Age_45_54_75K",	"Male_Income_Age_45_54_100K",	"Male_Income_Age_45_54_150K",	"Male_Income_Age_45_54_200K",	"Male_Income_Age_45_54_250K",	"Male_Income_Age_45_54_Total",	"Male_Income_Age_55_64_Less5K",	"Male_Income_Age_55_64_5K",	"Male_Income_Age_55_64_10K",	"Male_Income_Age_55_64_15K",	"Male_Income_Age_55_64_20K",	"Male_Income_Age_55_64_25K",	"Male_Income_Age_55_64_35K",	"Male_Income_Age_55_64_50K",	"Male_Income_Age_55_64_75K",	"Male_Income_Age_55_64_100K",	"Male_Income_Age_55_64_150K",	"Male_Income_Age_55_64_200K",	"Male_Income_Age_55_64_250K",	"Male_Income_Age_55_64_Total",	"Male_Income_Age_65P_Less5K",	"Male_Income_Age_65P_5K",	"Male_Income_Age_65P_10K",	"Male_Income_Age_65P_15K",	"Male_Income_Age_65P_20K",	"Male_Income_Age_65P_25K",	"Male_Income_Age_65P_35K",	"Male_Income_Age_65P_50K",	"Male_Income_Age_65P_75K",	"Male_Income_Age_65P_100K",	"Male_Income_Age_65P_150K",	"Male_Income_Age_65P_200K",	"Male_Income_Age_65P_250K",	"Male_Income_Age_65P_Total",	"Male_Income_Age_65P_Less5K",	"Male_Income_Age_0_24_5K",	"Male_Income_Age_0_24_10K",	"Male_Income_Age_0_24_15K",	"Male_Income_Age_0_24_20K",	"Male_Income_Age_0_24_25K",	"Male_Income_Age_0_24_35K",	"Male_Income_Age_0_24_50K",	"Male_Income_Age_0_24_75K",	"Male_Income_Age_0_24_100K",	"Male_Income_Age_0_24_150K",	"Male_Income_Age_0_24_200K",	"Male_Income_Age_0_24_250K",	"Male_Income_Age_0_24_Total", "Male_2015_Median"),
    "8", "3", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"Govt_Transfer_Males",	"Govt_Transfer_Females",	"Govt_Transfer",	"Govt_Transfer_Males_Dollar_000",	"Govt_Transfer_Females_Dollar_000",	"Govt_Transfer_Dollar_000",	"Govt_TransferEDR_Males",	"Govt_TransferEDR_Females",	"Govt_TransferEDR",	"EDR_Prov_Index_Males",	"EDR_Prov_Index_Females",	"EDR_Prov_Index",	"EDR_Canada_Index_Males",	"EDR_Canada_Index_Females",	"EDR_Canada_Index",	"EmpI_In_Males",	"EmpI_In_Females",	"EmpI_In",	"EmpI_In_Males_Dollar_000",	"EmpI_In_Females_Dollar_000",	"EmpI_In_Dollar_000",	"EI_Males",	"EI_Females",	"EI",	"EI_Males_Dollar_000",	"EI_Females_Dollar_000",	"EI_Dollar_000",	"EI_EDR_Males",	"EI_EDR_Females",	"EI_EDR",	"GST_HST_Males",	"GST_HST_Females",	"GST_HST",	"GST_HST_Males_Dollar_000",	"GST_HST_Females_Dollar_000",	"GST_HST_Dollar_000",	"GST_HST_EDR_Males_Dollar_000",	"GST_HST_EDR_Females_Dollar_000",	"GST_HST_EDR_Dollar_000",	"CCTB_Males",	"CCTB_Females",	"CCTB",	"CCTB_Males_Dollar_000",	"CCTB_Females_Dollar_000",	"CCTB_Dollar_000",	"CCTB_EDR_Males",	"CCTB_EDR_Females",	"CCTB_EDR",	"OAS_NFS_Males",	"OAS_NFS_Females",	"OAS_NFS",	"OAS_NFS_Males_Dollar_000",	"OAS_NFS_Females_Dollar_000",	"OAS_NFS_Dollar_000",	"OAS_NFS_EDR_Males",	"OAS_NFS_EDR_Females",	"OAS_NFS_EDR",	"CPP_QPP_Males",	"CPP_QPP_Females",	"CPP_QPP",	"CPP_QPP_Males_Dollar_000",	"CPP_QPP_Females_Dollar_000",	"CPP_QPP_Dollar_000",	"CPP_QPP_EDR_Males",	"CPP_QPP_EDR_Females",	"CPP_QPP_EDR",	"Work_Comp_Males",	"Work_Comp_Females",	"Work_Comp",	"Work_Comp_Males_Dollar_000",	"Work_Comp_Females_Dollar_000",	"Work_Comp_Dollar_000",	"Work_CompEDR_Males",	"Work_CompEDR_Females",	"WorkEDR_Comp",	"SA_Males",	"SA_Females",	"SA",	"SA_Males_Dollar_000",	"SA_Females_Dollar_000",	"SA_Dollar_000",	"SA_EDR_Males",	"SA_EDR_Females",	"SA_EDR",	"PRTC_FB_Males",	"PRTC_FB_Males",	"PRTC_FB",	"PRTC_FB_Males_Dollar_000",	"PRTC_FB_Males_Dollar_000",	"PRTC_FB_Dollar_000",	"PRTC_FB_EDR_Males",	"PRTC_FB_EDR_Males",	"PRTC_EDR_FB",	"Oth_Govt_Transfer_Males",	"Oth_Govt_Transfer_Females",	"Oth_Govt_Transfer",	"OGT_Males_Dollar_000",	"OGT_Females_Dollar_000",	"OGT_Dollar_000",	"OGT_EDR_Males",	"OGT_EDR_Females",	"OGT_EDR"),
    "9", "3", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name",	"Govt_Transfer_Males",	"Govt_Transfer_Females",	"Govt_Transfer",	"Govt_Transfer_Males_Dollar_000",	"Govt_Transfer_Females_Dollar_000",	"Govt_Transfer_Dollar_000",	"Govt_TransferEDR_Males",	"Govt_TransferEDR_Females",	"Govt_TransferEDR",	"EDR_Prov_Index_Males",	"EDR_Prov_Index_Females",	"EDR_Prov_Index",	"EDR_Canada_Index_Males",	"EDR_Canada_Index_Females",	"EDR_Canada_Index",	"EmpI_In_Males",	"EmpI_In_Females",	"EmpI_In",	"EmpI_In_Males_Dollar_000",	"EmpI_In_Females_Dollar_000",	"EmpI_In_Dollar_000",	"EI_Males",	"EI_Females",	"EI",	"EI_Males_Dollar_000",	"EI_Females_Dollar_000",	"EI_Dollar_000",	"EI_EDR_Males",	"EI_EDR_Females",	"EI_EDR",	"GST_HST_Males",	"GST_HST_Females",	"GST_HST",	"GST_HST_Males_Dollar_000",	"GST_HST_Females_Dollar_000",	"GST_HST_Dollar_000",	"GST_HST_EDR_Males_Dollar_000",	"GST_HST_EDR_Females_Dollar_000",	"GST_HST_EDR_Dollar_000",	"CCTB_Males",	"CCTB_Females",	"CCTB",	"CCTB_Males_Dollar_000",	"CCTB_Females_Dollar_000",	"CCTB_Dollar_000",	"CCTB_EDR_Males",	"CCTB_EDR_Females",	"CCTB_EDR",	"OAS_NFS_Males",	"OAS_NFS_Females",	"OAS_NFS",	"OAS_NFS_Males_Dollar_000",	"OAS_NFS_Females_Dollar_000",	"OAS_NFS_Dollar_000",	"OAS_NFS_EDR_Males",	"OAS_NFS_EDR_Females",	"OAS_NFS_EDR",	"CPP_QPP_Males",	"CPP_QPP_Females",	"CPP_QPP",	"CPP_QPP_Males_Dollar_000",	"CPP_QPP_Females_Dollar_000",	"CPP_QPP_Dollar_000",	"CPP_QPP_EDR_Males",	"CPP_QPP_EDR_Females",	"CPP_QPP_EDR",	"Work_Comp_Males",	"Work_Comp_Females",	"Work_Comp",	"Work_Comp_Males_Dollar_000",	"Work_Comp_Females_Dollar_000",	"Work_Comp_Dollar_000",	"Work_CompEDR_Males",	"Work_CompEDR_Females",	"WorkEDR_Comp",	"SA_Males",	"SA_Females",	"SA",	"SA_Males_Dollar_000",	"SA_Females_Dollar_000",	"SA_Dollar_000",	"SA_EDR_Males",	"SA_EDR_Females",	"SA_EDR",	"PRTC_FB_Males",	"PRTC_FB_Males",	"PRTC_FB",	"PRTC_FB_Males_Dollar_000",	"PRTC_FB_Males_Dollar_000",	"PRTC_FB_Dollar_000",	"PRTC_FB_EDR_Males",	"PRTC_FB_EDR_Males",	"PRTC_EDR_FB",	"Oth_Govt_Transfer_Males",	"Oth_Govt_Transfer_Females",	"Oth_Govt_Transfer",	"OGT_Males_Dollar_000",	"OGT_Females_Dollar_000",	"OGT_Dollar_000",	"OGT_EDR_Males",	"OGT_EDR_Females",	"OGT_EDR"),
    "10", "4", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name", "Total_Males",	"Total_Females",	"Total_All",	"Taxfilers_Males",	"Taxfilers_Females",	"Taxfilers_All",	"Income_Males",	"Income_Femles",	"Income_Total",	"Income_Males_Dollar_000",	"Income_Females_Dollar_000",	"Income_Dollar_000",	"Median_Inc_Males",	"Median_Inc_Females",	"Median_Inc_Total",	"Prov_Index_Males",	"Prov_Index_Females",	"Prov_Index",	"Can_Index_Males",	"Can_Index_Females",	"Can_Index",	"Lab_Inc_Males",	"Lab_Inc_Females",	"Lab_Inc",	"Lab_Inc_Males_Dollar_000",	"Lab_Inc_Females_Dollar_000",	"Lab_Inc_Dollar_000",	"EI_Males",	"EI_Females",	"EI",	"EI_Males_Dollar_000",	"EI_Females_Dollar_000",	"EI_Dollar_000",	"EI_Median_Males",	"EI_Median_Females",	"EI_Median",	"EI_Prov_Index_Males",	"EI_Prov_Index_Females",	"EI_Prov_Index",	"EI_Can_Index_Males",	"EI_Can_Index_Females",	"EI_Can_Index",	"Wages_Males",	"Wages_Females",	"Wages_Total",	"Wages_Males_Dollar_000",	"Wages_Females_Dollar_000",	"Wages_Total_Dollar_000",	"Self_Empl_Males",	"Self_Empl_Females",	"Self_Empl",	"Self_Empl_Males_Dollar_000",	"Self_Empl_Females_Dollar_000",	"Self_Empl_Dollar_000",	"Wages_Only_Males",	"Wages_Only_Females",	"Wages_Only_Total",	"Wages_Only_Males_Dollar_000",	"Wages_Only_Females_Dollar_000",	"Wages_Only_Total_Dollar_000",	"Self_Empl_Only_Males",	"Self_Empl_Only_Females",	"Self_Empl_Only",	"Self_Empl_Only_Males_Dollar_000",	"Self_Empl_Only_Females_Dollar_000",	"Self_Empl_Only_Dollar_000",	"Wages_Self_Emp_Males",	"Wages_Self_Emp_Females",	"Wages_Self_Emp_Total",	"Wages_Self_Emp_Males_Dollar_000",	"Wages_Self_Emp_Females_Dollar_000",	"Wages_Self_Emp_Total_Dollar_000",	"E_Ins_Males",	"E_Ins_Females",	"E_Ins",	"E_Ins_Males_Dollar_000",	"E_Ins_Females_Dollar_000",	"E_Ins_Dollar_000",	"E_Ins_EDR_Males",	"E_Ins_EDR_Females",	"E_Ins_EDR",	"E_Ins_Prov_Index_Males",	"E_Ins_Prov_Index_Females",	"E_Ins_Prov_Index",	"E_Ins_Can_Index_Males",	"E_Ins_Can_Index_Females",	"E_Ins_Can_Index"),
    "11", "4", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name", "M_15_19", 	"M_20_24",	"M_25_29",	"M_30_34", 	"M_35_39",	"M_40_44", 	"M_45_49", 	"M_50_54",	"M_55_59",	"M_60_64",	"M_65P",	"M_Total",	"F_15_19", 	"F_20_24",	"F_25_29",	"F_30_34", 	"F_35_39",	"F_40_44", 	"F_45_49", 	"F_50_54",	"F_55_59",	"F_60_64",	"F_65P",	"F_Total",	"All_15_19", 	"All_20_24",	"All_25_29",	"All_30_34", 	"All_35_39",	"All_40_44", 	"All_45_49", 	"All_50_54",	"All_55_59",	"All_60_64",	"All_65P",	"All_Total",	"M_Lab_Inc_15_19", 	"M_Lab_Inc_20_24",	"M_Lab_Inc_25_29",	"M_Lab_Inc_30_34", 	"M_Lab_Inc_35_39",	"M_Lab_Inc_40_44", 	"M_Lab_Inc_45_49", 	"M_Lab_Inc_50_54",	"M_Lab_Inc_55_59",	"M_Lab_Inc_60_64",	"M_Lab_Inc_65P",	"M_Lab_Inc_Total",	"F_Lab_Inc_15_19", 	"F_Lab_Inc_20_24",	"F_Lab_Inc_25_29",	"F_Lab_Inc_30_34", 	"F_Lab_Inc_35_39",	"F_Lab_Inc_40_44", 	"F_Lab_Inc_45_49", 	"F_Lab_Inc_50_54",	"F_Lab_Inc_55_59",	"F_Lab_Inc_60_64",	"F_Lab_Inc_65P",	"F_Lab_Inc_Total",	"All_Lab_Inc_15_19", 	"All_Lab_Inc_20_24",	"All_Lab_Inc_25_29",	"All_Lab_Inc_30_34", 	"All_Lab_Inc_35_39",	"All_Lab_Inc_40_44", 	"All_Lab_Inc_45_49", 	"All_Lab_Inc_50_54",	"All_Lab_Inc_55_59",	"All_Lab_Inc_60_64",	"All_Lab_Inc_65P",	"All_Lab_Inc_Total",	"M_Part_Rate_15_19", 	"M_Part_Rate_20_24",	"M_Part_Rate_25_29",	"M_Part_Rate_30_34", 	"M_Part_Rate_35_39",	"M_Part_Rate_40_44", 	"M_Part_Rate_45_49", 	"M_Part_Rate_50_54",	"M_Part_Rate_55_59",	"M_Part_Rate_60_64",	"M_Part_Rate_65P",	"M_Part_Rate_Total",	"F_Part_Rate_15_19", "F_Part_Rate_20_24",	"F_Part_Rate_25_29",	"F_Part_Rate_30_34", 	"F_Part_Rate_35_39",	"F_Part_Rate_40_44", 	"F_Part_Rate_45_49", 	"F_Part_Rate_50_54",	"F_Part_Rate_55_59",	"F_Part_Rate_60_64",	"F_Part_Rate_65P",	"F_Part_Rate_Total",	"All_Part_Rate_15_19", 	"All_Part_Rate_20_24",	"All_Part_Rate_25_29",	"All_Part_Rate_30_34", 	"All_Part_Rate_35_39",	"All_Part_Rate_40_44", 	"All_Part_Rate_45_49", 	"All_Part_Rate_50_54",	"All_Part_Rate_55_59",	"All_Part_Rate_60_64",	"All_Part_Rate_65P",	"All_Part_Rate_Total"),
    "12", "4", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name", "Inc_Lab_M_15_19", "Inc_Lab_M_20_24",	"Inc_Lab_M_25_29",	"Inc_Lab_M_30_34", 	"Inc_Lab_M_35_39",	"Inc_Lab_M_40_44", 	"Inc_Lab_M_45_49", "Inc_Lab_M_50_54",	"Inc_Lab_M_55_59",	"Inc_Lab_M_60_64",	"Inc_Lab_M_65P",	"Inc_Lab_M_Total",	"Inc_Lab_F_15_19", 	"Inc_Lab_F_20_24",	"Inc_Lab_F_25_29", "Inc_Lab_F_30_34", 	"Inc_Lab_F_35_39",	"Inc_Lab_F_40_44", 	"Inc_Lab_F_45_49", 	"Inc_Lab_F_50_54",	"Inc_Lab_F_55_59",	"Inc_Lab_F_60_64",	"Inc_Lab_F_65P",	"Inc_Lab_F_Total",	"Inc_Lab_All_15_19", 	"Inc_Lab_All_20_24",	"Inc_Lab_All_25_29",	"Inc_Lab_All_30_34",	"Inc_Lab_All_35_39",	"Inc_Lab_All_40_44", 	"Inc_Lab_All_45_49", 	"Inc_Lab_All_50_54",	"Inc_Lab_All_55_59",	"Inc_Lab_All_60_64",	"Inc_Lab_All_65P",	"Inc_Lab_All_Total",	"EI_M_5_19", 	"EI_M_20_24", "EI_M_25_29",	"EI_M_30_34", 	"EI_M_35_39",	"EI_M_40_44", 	"EI_M_45_49", 	"EI_M_50_54",	"EI_M_55_59",	"EI_M_60_64",	"EI_M_65P",	"EI_M_Total",	"EI_F_15_19", 	"EI_F_20_24",	"EI_F_25_29",	"EI_F_30_34", 	"EI_F_35_39",	"EI_F_40_44", 	"EI_F_45_49", 	"EI_F_50_54",	"EI_F_55_59",	"EI_F_60_64",	"EI_F_65P",	"EI_F_Total",	"All_EI_15_19", 	"All_EI_20_24",	"All_EI_25_29",	"All_EI_30_34", 	"All_EI_35_39",	"All_EI_40_44", 	"All_EI_45_49", 	"All_EI_50_54",	"All_EI_55_59",	"All_EI_60_64",	"All_EI_65P",	"All_EI_Total"),
    "13", "4", c("City_ID", "Postal_Area", "Postal_Walk", "Geo_Level", "Place_Name","CoupleFamily_LowIncome_0_Child","CoupleFamily_LowIncome_1_Child","CoupleFamily_LowIncome_2_Child","CoupleFamily_LowIncome_3_Child","CoupleFamily_LowIncome_Total","Percent_LowIncome_0_Child","Percent_LowIncome_1_Child","Percent_LowIncome_2_Child","Percent_LowIncome_3_Child","Percent_LowIncome_Total","Avg_LowIncome_Ratio_0_Child","Avg_LowIncome_Ratio_1_Child","Avg_LowIncome_Ratio_2_Child","Avg_LowIncome_Ratio_3_Child","Avg_LowIncome_Ratio","Age_0_17_LowIncome_0_Child","Age_0_17_LowIncome_1_Child","Age_0_17_LowIncome_2_Child","Age_0_17_LowIncome_3_Child","Age_0_17_LowIncome","Percent_0_17_LowIncome_0_Child","Percent_0_17_LowIncome_1_Child","Percent_0_17_LowIncome_2_Child","Percent_0_17_LowIncome_3_Child","Percent_0_17_LowIncome_Total","Avg_0_17_LowIncome_Ratio_0_Child","Avg_0_17_LowIncome_Ratio_1_Child","Avg_0_17_LowIncome_Ratio_2_Child","Avg_0_17_LowIncome_Ratio_3_Child","Avg_0_17_LowIncome_Ratio","Age_18_64_LowIncome_0_Child","Age_18_64_LowIncome_1_Child","Age_18_64_LowIncome_2_Child","Age_18_64_LowIncome_3_Child","Age_18_64_LowIncome","Percent_18_64_LowIncome_0_Child","Percent_18_64_LowIncome_1_Child","Percent_18_64_LowIncome_2_Child","Percent_18_64_LowIncome_3_Child","Percent_18_64_LowIncome_Total","Avg_18_64_LowIncome_Ratio_0_Child","Avg_18_64_LowIncome_Ratio_1_Child","Avg_18_64_LowIncome_Ratio_2_Child","Avg_18_64_LowIncome_Ratio_3_Child","Avg_18_64_LowIncome_Ratio","Age_65P_LowIncome_0_Child","Age_65P_LowIncome_1_Child","Age_65P_LowIncome_2_Child","Age_65P_LowIncome_3_Child","Age_65P_LowIncome","Percent_65P_LowIncome_0_Child","Percent_65P_LowIncome_1_Child","Percent_65P_LowIncome_2_Child","Percent_65P_LowIncome_3_Child","Percent_65P_LowIncome_Total","Avg_65P_LowIncome_Ratio_0_Child","Avg_65P_LowIncome_Ratio_1_Child","Avg_65P_LowIncome_Ratio_2_Child","Avg_65P_LowIncome_Ratio_3_Child","Avg_65P_LowIncome_Ratio","LoneParent_LowIncome_1_Child","LoneParent_LowIncome_2_Child","LoneParent_LowIncome_3_Child","LoneParent_LowIncome","LoneParent_Percent_LowIncome_1_Child","LoneParent_Percent_LowIncome_2_Child","LoneParent_Percent_LowIncome_3_Child","LoneParent_Percent_LowIncome","LoneParent_Avg_LowIncome_1_Child","LoneParent_Avg_LowIncome_Ratio_2_Child","LoneParent_Avg_LowIncome_Ratio_3_Child","LoneParent_Avg_LowIncome_Ratio","LoneParent_Age_0_17_LowIncome_1_Child","LoneParent_Age_0_17_LowIncome_2_Child","LoneParent_Age_0_17_LowIncome_3_Child","LoneParent_Age_0_17_LowIncome","Percent_LoneParent_Age_0_17_LowIncome_1_Child","Percent_LoneParent_Age_0_17_LowIncome_2_Child","Percent_LoneParent_Age_0_17_LowIncome_3_Child","Percent_LoneParent_Age_0_17_LowIncome","Avg_LoneParent_Age_0_17_LowIncome_1_Child","Avg_LoneParent_Age_0_17_LowIncome_2_Child","Avg_LoneParent_Age_0_17_LowIncome_3_Child","Avg_LoneParent_Age_0_17_LowIncome","Age_18_64_LowIncome_1_Child","Age_18_64_LowIncome_2_Child","Age_18_64_LowIncome_3_Child","Age_18_64_LowIncome","Percent_18_64_LowIncome_1_Child",
                 "Percent_18_64_LowIncome_2_Child","Percent_18_64_LowIncome_3_Child","Percent_18_64_LowIncome","Avg_18_64_LowIncome_1_Child","Avg_18_64_LowIncome_2_Child","Avg_18_64_LowIncome_3_Child","Avg_18_64_LowIncome","Age_65P_LowIncome_1_Child","Age_65P_LowIncome_2_Child","Age_65P_LowIncome_3_Child","Age_65P_LowIncome","Percent_65P_LowIncome_1_Child","Percent_65P_LowIncome_2_Child","Percent_65P_LowIncome_3_Child","Percent_65P_LowIncome","Avg_65P_LowIncome_1_Child","Avg_65P_LowIncome_2_Child","Avg_65P_LowIncome_3_Child", "Avg_65P_LowIncome","Families_LowIncome_0_Child","Families_LowIncome_1_Child","Families_LowIncome_2_Child","Families_LowIncome_3_Child","Families_LowIncome","Percent_Families_LowIncome_0_Child","Percent_Families_LowIncome_1_Child","Percent_Families_LowIncome_2_Child","Percent_Families_LowIncome_3_Child","Percent_Families_LowIncome","Avg_Families_LowIncome_0_Child","Avg_Families_LowIncome_1_Child","Avg_Families_LowIncome_2_Child","Avg_Families_LowIncome_3_Child","Avg_Families_LowIncome","Families_0_17_LowIncome_0_Child","Families_0_17_LowIncome_1_Child","Families_0_17_LowIncome_2_Child","Families_0_17_LowIncome_3_Child","Families_0_17_LowIncome","Percent_Families_0_17_LowIncome_0_Child","Percent_Families_0_17_LowIncome_1_Child","Percent_Families_0_17_LowIncome_2_Child","Percent_Families_0_17_LowIncome_3_Child","Percent_Families_0_17_LowIncome","Avg_Families_0_17_LowIncome_0_Child","Avg_Families_0_17_LowIncome_1_Child","Avg_Families_0_17_LowIncome_2_Child","Avg_Families_0_17_LowIncome_3_Child","Avg_Families_0_17_LowIncome","Age_Families_18_64_LowIncome_0_Child","Age_Families_18_64_LowIncome_1_Child","Age_Families_18_64_LowIncome_2_Child","Avg_Families_18_64_LowIncome_3_Child","Age_Families_18_64_LowIncome", "Percent_Families_18_64_LowIncome_0_Child","Percent_Families_18_64_LowIncome_1_Child","Percent_Families_18_64_LowIncome_2_Child","Percent_Families_18_64_LowIncome_3_Child","Percent_Families_18_64_LowIncome","Avg_Families_LowIncome_0_Child","Avg_Families_LowIncome_1_Child","Avg_Families_LowIncome_2_Child","Avg_Families_LowIncome_3_Child","Avg_Families_LowIncome","Age_65P_Families_LowIncome_0_Child","Age_65P_Families_LowIncome_1_Child","Age_65P_Families_LowIncome_2_Child","Age_65P_Families_LowIncome_3_Child","Age_65P_Families_LowIncome","Percent_Families_LowIncome_0_Child","Percent_Families_LowIncome_1_Child","Percent_Families_LowIncome_2_Child","Percent_Families_LowIncome_3_Child","Percent_Families_LowIncome","Avg_Families_LowIncome_0_Child","Avg_Families_LowIncome_1_Child","Avg_Families_LowIncome_2_Child","Avg_Families_LowIncome_3_Child","Avg_Families_LowIncome","NonFamily_LowIncome_0_Child","NonFamily_LowIncome","Percent_NonFamily_LowIncome_0_Child","Percent_NonFamily_LowIncome","Avg_NonFamily_LowIncome_0_Child","Avg_NonFamily_LowIncome","Non_Family_Age_0_17_LowIncome_0_Child","Non_Family_Age_0_17_LowIncome","Percent_Age_0_17_Non_Family_LowIncome_0_Child","Percent_Age_0_17_Non_Family_LowIncome",
                 "Avg_Age_0_17_Non_Family_LowIncome_0_Child","Avg_Age_0_17_Non_Family_LowIncome","Age_18_64_Non_Family_LowIncome_0_Child","Age_18_64_Non_Family_LowIncome","Percent_18_64_Non_Family_LowIncome_0_Child","Percent_18_64_Non_Family_LowIncome","Avg_18_64_Non_Family_LowIncome_0_Child","Avg_18_64_Non_Family_LowIncome","Age_65P_Non_Family_LowIncome_0_Child","Age_65P_Non_Family_LowIncome","Percent_65P_Non_Family_LowIncome_0_Child","Percent_65P_Non_Family_LowIncome","Avg_65P_Non_Family_LowIncome_0_Child","Avg_65P_Non_Family_LowIncome","AllFamilies_LowIncome_0_Child","AllFamilies_LowIncome_1_Child","AllFamilies_LowIncome_2_Child","AllFamilies_LowIncome_3_Child","AllFamilies_LowIncome","Percent_AllFamilies_LowIncome_0_Child","Percent_AllFamilies_LowIncome_1_Child","Percent_AllFamilies_LowIncome_2_Child","Percent_AllFamilies_LowIncome_3_Child","Percent_AllFamilies_LowIncome","Avg_AllFamilies_LowIncome_0_Child","Avg_AllFamilies_LowIncome_1_Child","Avg_AllFamilies_LowIncome_2_Child","Avg_AllFamilies_LowIncome_3_Child","Avg_AllFamilies_LowIncome","AllFamilies_0_17_LowIncome_0_Child","AllFamilies_0_17_LowIncome_1_Child","AllFamilies_0_17_LowIncome_2_Child","AllFamilies_0_17_LowIncome_3_Child","AllFamilies_0_17_LowIncome","Percent_AllFamilies_0_17_LowIncome_0_Child","Percent_AllFamilies_0_17_LowIncome_1_Child","Percent_AllFamilies_0_17_LowIncome_2_Child","Percent_AllFamilies_0_17_LowIncome_3_Child","Percent_AllFamilies_0_17_LowIncome","Avg_AllFamilies_0_17_LowIncome_0_Child","Avg_AllFamilies_0_17_LowIncome_1_Child","Avg_AllFamilies_0_17_LowIncome_2_Child","Avg_AllFamilies_0_17_LowIncome_3_Child","Avg_AllFamilies_0_17_LowIncome","Age_AllFamilies_18_64_LowIncome_0_Child","Age_AllFamilies_18_64_LowIncome_1_Child","Age_AllFamilies_18_64_LowIncome_2_Child","Avg_AllFamilies_18_64_LowIncome_3_Child","Age_AllFamilies_18_64_LowIncome","Percent_AllFamilies_18_64_LowIncome_0_Child","Percent_AllFamilies_18_64_LowIncome_1_Child","Percent_AllFamilies_18_64_LowIncome_2_Child","Percent_AllFamilies_18_64_LowIncome_3_Child","Percent_AllFamilies_18_64_LowIncome","Avg_AllFamilies_LowIncome_0_Child","Avg_AllFamilies_LowIncome_1_Child","Avg_AllFamilies_LowIncome_2_Child","Avg_AllFamilies_LowIncome_3_Child","Avg_AllFamilies_LowIncome","Age_65P_AllFamilies_LowIncome_0_Child","Age_65P_AllFamilies_LowIncome_1_Child","Age_65P_AllFamilies_LowIncome_2_Child","Age_65P_AllFamilies_LowIncome_3_Child","Age_65P_AllFamilies_LowIncome","Percent_AllFamilies_LowIncome_0_Child","Percent_Families_LowIncome_1_Child","Percent_AllFamilies_LowIncome_2_Child","Percent_AllFamilies_LowIncome_3_Child","Percent_AllFamilies_LowIncome","Avg_AllFamilies_LowIncome_0_Child","Avg_AllFamilies_LowIncome_1_Child","Avg_AllFamilies_LowIncome_2_Child","Avg_AllFamilies_LowIncome_3_Child", "Avg_AllFamilies_LowIncome")
  ) %>% 
    mutate(skiprow = as.integer(skiprow))
  
   pathbase <- path %>%
    basename() %>%
    tools::file_path_sans_ext()
  
  sheetskiprows <- meta %>% filter(sheetno == sheet) %>% pull(skiprow)
  sheetcolnames <- meta %>% filter(sheetno == sheet) %>% select(sheetcolumnnames)
  
  path %>%
    read_excel(sheet = sheet, skip = sheetskiprows, col_names = c(sheetcolnames)) %>% 
    write_csv(paste0("tmp/", pathbase, "-", sheet, ".csv"))
}

meta %>% filter(sheetno == 1) %>% pull(skiprow)
foo <- meta %>% filter(sheetno == 1) %>% select(sheetcolumnnames)

filename <- "2015_IND_Tables 1_to_13_Canada.xls"
filefolder <- "Data/ind"
filepath <- here(filefolder, filename)

# sheets <- excel_sheets(filepath)

read_then_csv("3A", path = filepath)

filepath %>%
  excel_sheets() %>%
  set_names() %>% 
  map(read_then_csv, path = filepath)


##### testing adding colnames

library(tribble)
library(dplyr)

foo <- tribble(
  ~sheetno, ~skiprow, ~sheetcolumnnames,
  "1", "4", c("hello", "hi", "salut"))
foo

foo %>% filter(sheetno == 1) %>% pull(skiprow)
foo %>% filter(sheetno == 1) %>% pull(sheetcolumnnames)

